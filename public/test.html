<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SignatureHub - API Test Console</title>
  <link rel="stylesheet" href="/css/style.css">
  <style>
    * { box-sizing: border-box; }
    body { background: #1a1a2e; color: #eee; font-family: 'Segoe UI', system-ui, sans-serif; }
    .test-container { max-width: 1400px; margin: 0 auto; padding: 20px; }

    .header {
      background: linear-gradient(135deg, #16213e 0%, #1a1a2e 100%);
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      border: 1px solid #0f3460;
    }
    .header h1 { margin: 0 0 10px 0; color: #e94560; }
    .header p { margin: 0; opacity: 0.8; }

    .api-key-bar {
      background: #16213e;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: flex;
      gap: 10px;
      align-items: center;
      border: 1px solid #0f3460;
    }
    .api-key-bar label { font-weight: 600; white-space: nowrap; }
    .api-key-bar input {
      flex: 1;
      padding: 10px;
      border: 1px solid #0f3460;
      border-radius: 4px;
      background: #1a1a2e;
      color: #eee;
    }
    .api-key-bar .status {
      padding: 8px 16px;
      border-radius: 4px;
      font-size: 0.85rem;
      font-weight: 600;
    }
    .status.connected { background: #155724; color: #d4edda; }
    .status.disconnected { background: #721c24; color: #f8d7da; }

    .tabs {
      display: flex;
      gap: 5px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .tab {
      padding: 10px 20px;
      background: #16213e;
      border: 1px solid #0f3460;
      border-radius: 6px 6px 0 0;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s;
    }
    .tab:hover { background: #0f3460; }
    .tab.active { background: #e94560; border-color: #e94560; color: white; }

    .panel { display: none; }
    .panel.active { display: block; }

    .endpoint-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    @media (max-width: 1000px) {
      .endpoint-grid { grid-template-columns: 1fr; }
    }

    .endpoint-card {
      background: #16213e;
      border: 1px solid #0f3460;
      border-radius: 8px;
      padding: 20px;
    }
    .endpoint-card h3 {
      margin: 0 0 5px 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .method {
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 700;
    }
    .method.get { background: #28a745; }
    .method.post { background: #007bff; }
    .method.put { background: #ffc107; color: #000; }
    .method.delete { background: #dc3545; }

    .endpoint-path {
      font-family: monospace;
      color: #aaa;
      font-size: 0.9rem;
      margin-bottom: 15px;
    }

    .form-row {
      margin-bottom: 12px;
    }
    .form-row label {
      display: block;
      font-size: 0.85rem;
      margin-bottom: 4px;
      color: #aaa;
    }
    .form-row input, .form-row textarea, .form-row select {
      width: 100%;
      padding: 8px;
      border: 1px solid #0f3460;
      border-radius: 4px;
      background: #1a1a2e;
      color: #eee;
      font-size: 0.9rem;
    }
    .form-row textarea {
      min-height: 80px;
      font-family: monospace;
    }
    .form-row input:focus, .form-row textarea:focus, .form-row select:focus {
      outline: none;
      border-color: #e94560;
    }

    .btn-send {
      background: #e94560;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      width: 100%;
      margin-top: 10px;
    }
    .btn-send:hover { background: #d63850; }
    .btn-send:disabled { background: #666; cursor: not-allowed; }

    .response-area {
      background: #0d0d1a;
      border: 1px solid #0f3460;
      border-radius: 8px;
      margin-top: 20px;
      overflow: hidden;
    }
    .response-header {
      background: #16213e;
      padding: 10px 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #0f3460;
    }
    .response-status { font-weight: 600; }
    .response-status.success { color: #28a745; }
    .response-status.error { color: #dc3545; }
    .response-body {
      padding: 15px;
      font-family: monospace;
      font-size: 0.85rem;
      white-space: pre-wrap;
      max-height: 300px;
      overflow-y: auto;
    }

    .quick-actions {
      background: #16213e;
      border: 1px solid #0f3460;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
    }
    .quick-actions h4 { margin: 0 0 10px 0; color: #e94560; }

    .btn-quick {
      padding: 8px 16px;
      background: #0f3460;
      border: 1px solid #0f3460;
      border-radius: 4px;
      color: #eee;
      cursor: pointer;
      font-size: 0.85rem;
    }
    .btn-quick:hover { background: #1a4a7a; }

    .saved-data {
      background: #0d0d1a;
      border: 1px solid #0f3460;
      border-radius: 4px;
      padding: 10px;
      margin-top: 10px;
      font-family: monospace;
      font-size: 0.8rem;
    }
    .saved-data .label { color: #e94560; }

    .hint { font-size: 0.8rem; color: #888; margin-top: 5px; }
  </style>
</head>
<body>
  <nav class="top-nav">
    <a href="/" class="brand">SignatureHub</a>
    <a href="/">Guide</a>
    <a href="/demo.html">Demo</a>
    <a href="/test.html" class="active">API Console</a>
    <a href="/docs/">API Docs</a>
  </nav>

  <div class="test-container">
    <div class="header">
      <h1>SignatureHub API Test Console</h1>
      <p>Test all API endpoints in your browser. Configure your API key below to get started.</p>
    </div>

    <div class="api-key-bar">
      <label for="globalApiKey">API Key:</label>
      <input type="password" id="globalApiKey" placeholder="Enter your API key">
      <button class="btn-quick" id="btn-toggle-key">Show</button>
      <button class="btn-quick" id="btn-test-connection">Test Connection</button>
      <span id="connectionStatus" class="status disconnected">Not tested</span>
    </div>

    <div class="quick-actions">
      <h4>Saved Context</h4>
      <div id="savedContext" class="saved-data">
        <span class="label">Last Request ID:</span> <span id="savedRequestId">-</span><br>
        <span class="label">Last Token:</span> <span id="savedToken">-</span><br>
        <span class="label">Last Reference:</span> <span id="savedReference">-</span><br>
        <span class="label">Last Package ID:</span> <span id="savedPackageId">-</span><br>
        <span class="label">Last Package Code:</span> <span id="savedPackageCode">-</span>
      </div>
    </div>

    <div class="tabs">
      <div class="tab active" data-panel="requests">Signature Requests</div>
      <div class="tab" data-panel="packages">Multi-Party Packages</div>
      <div class="tab" data-panel="templates">Templates</div>
      <div class="tab" data-panel="signing">Signing Flow</div>
      <div class="tab" data-panel="fulltest">Full Test</div>
    </div>

    <!-- SIGNATURE REQUESTS PANEL -->
    <div id="panel-requests" class="panel active">
      <div class="endpoint-grid">

        <!-- Create Request -->
        <div class="endpoint-card">
          <h3><span class="method post">POST</span> Create Request</h3>
          <div class="endpoint-path">/api/requests</div>

          <div class="form-row">
            <label>Document Name *</label>
            <input type="text" id="cr-documentName" value="Test Agreement">
          </div>
          <div class="form-row">
            <label>Signer Name *</label>
            <input type="text" id="cr-signerName" value="Test User">
          </div>
          <div class="form-row">
            <label>Signer Email</label>
            <input type="email" id="cr-signerEmail" placeholder="test@example.com">
          </div>
          <div class="form-row">
            <label>Signer Phone (E.164 format)</label>
            <input type="tel" id="cr-signerPhone" placeholder="+15551234567">
          </div>
          <div class="form-row">
            <label>Verification Method (optional)</label>
            <select id="cr-verificationMethod">
              <option value="">Auto-detect</option>
              <option value="email">Email only</option>
              <option value="sms">SMS only</option>
              <option value="both">Both</option>
            </select>
            <p class="hint">Auto-detects: email if provided, SMS if phone provided, both if both</p>
          </div>
          <div class="form-row">
            <label>Document Content (HTML)</label>
            <textarea id="cr-documentContent">&lt;h3&gt;Test Agreement&lt;/h3&gt;&lt;p&gt;This is a test document for API testing.&lt;/p&gt;</textarea>
          </div>
          <div class="form-row">
            <label>Callback URL (optional)</label>
            <input type="url" id="cr-callbackUrl" placeholder="https://your-server.com/webhook">
          </div>
          <div class="form-row">
            <label>External Reference (optional)</label>
            <input type="text" id="cr-externalRef" placeholder="your-system-id-123">
          </div>

          <button class="btn-send" id="btn-createRequest">Create Request</button>
          <div id="response-createRequest" class="response-area" style="display:none;"></div>
        </div>

        <!-- List Requests -->
        <div class="endpoint-card">
          <h3><span class="method get">GET</span> List Requests</h3>
          <div class="endpoint-path">/api/requests</div>

          <div class="form-row">
            <label>Status Filter</label>
            <select id="lr-status">
              <option value="">All</option>
              <option value="pending">Pending</option>
              <option value="viewed">Viewed</option>
              <option value="verified">Verified</option>
              <option value="signed">Signed</option>
              <option value="cancelled">Cancelled</option>
              <option value="expired">Expired</option>
            </select>
          </div>
          <div class="form-row">
            <label>Signer Email</label>
            <input type="text" id="lr-signerEmail" placeholder="Filter by email">
          </div>
          <div class="form-row">
            <label>Limit</label>
            <input type="number" id="lr-limit" value="10">
          </div>

          <button class="btn-send" id="btn-listRequests">List Requests</button>
          <div id="response-listRequests" class="response-area" style="display:none;"></div>
        </div>

        <!-- Get Request by ID -->
        <div class="endpoint-card">
          <h3><span class="method get">GET</span> Get Request by ID</h3>
          <div class="endpoint-path">/api/requests/:id</div>

          <div class="form-row">
            <label>Request ID *</label>
            <input type="text" id="gr-id" placeholder="Enter request ID">
            <button class="btn-quick use-saved" data-target="gr-id" data-field="requestId" style="margin-top:5px;">Use Saved</button>
          </div>

          <button class="btn-send" id="btn-getRequest">Get Request</button>
          <div id="response-getRequest" class="response-area" style="display:none;"></div>
        </div>

        <!-- Get Request by Reference -->
        <div class="endpoint-card">
          <h3><span class="method get">GET</span> Get Request by Reference</h3>
          <div class="endpoint-path">/api/requests/ref/:referenceCode</div>

          <div class="form-row">
            <label>Reference Code *</label>
            <input type="text" id="grr-ref" placeholder="Enter reference code">
            <button class="btn-quick use-saved" data-target="grr-ref" data-field="reference" style="margin-top:5px;">Use Saved</button>
          </div>

          <button class="btn-send" id="btn-getRequestByRef">Get Request</button>
          <div id="response-getRequestByRef" class="response-area" style="display:none;"></div>
        </div>

        <!-- Get Signature -->
        <div class="endpoint-card">
          <h3><span class="method get">GET</span> Get Signature</h3>
          <div class="endpoint-path">/api/requests/:id/signature</div>

          <div class="form-row">
            <label>Request ID *</label>
            <input type="text" id="gs-id" placeholder="Enter request ID">
            <button class="btn-quick use-saved" data-target="gs-id" data-field="requestId" style="margin-top:5px;">Use Saved</button>
          </div>

          <button class="btn-send" id="btn-getSignature">Get Signature</button>
          <div id="response-getSignature" class="response-area" style="display:none;"></div>
        </div>

        <!-- Cancel Request -->
        <div class="endpoint-card">
          <h3><span class="method delete">DELETE</span> Cancel Request</h3>
          <div class="endpoint-path">/api/requests/:id</div>

          <div class="form-row">
            <label>Request ID *</label>
            <input type="text" id="dr-id" placeholder="Enter request ID">
            <button class="btn-quick use-saved" data-target="dr-id" data-field="requestId" style="margin-top:5px;">Use Saved</button>
          </div>

          <button class="btn-send" id="btn-cancelRequest">Cancel Request</button>
          <div id="response-cancelRequest" class="response-area" style="display:none;"></div>
        </div>

      </div>
    </div>

    <!-- MULTI-PARTY PACKAGES PANEL -->
    <div id="panel-packages" class="panel">
      <div class="endpoint-grid">

        <!-- Create Package -->
        <div class="endpoint-card" style="grid-column: span 2;">
          <h3><span class="method post">POST</span> Create Multi-Party Package</h3>
          <div class="endpoint-path">/api/packages</div>
          <p class="hint">Create a signing package for multiple signers with role consolidation</p>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div>
              <div class="form-row">
                <label>Template Code (optional)</label>
                <select id="cp-templateCode">
                  <option value="">-- No template (use custom content) --</option>
                </select>
                <button class="btn-quick" id="btn-loadPackageTemplates" style="margin-top:5px;">Refresh Templates</button>
                <p class="hint">Use a pre-defined template. Leave empty for custom content.</p>
              </div>
              <div class="form-row">
                <label>Document Name</label>
                <input type="text" id="cp-documentName" value="Team Waiver Agreement">
              </div>
              <div class="form-row">
                <label>Document Content (HTML, if no template)</label>
                <textarea id="cp-documentContent" style="min-height: 100px;">&lt;h2&gt;{{documentName}}&lt;/h2&gt;
&lt;p&gt;Event Date: {{eventDate}}&lt;/p&gt;
&lt;p&gt;Participant: {{signerName}}&lt;/p&gt;
&lt;p&gt;Signing as: {{signerRoles}}&lt;/p&gt;
{{jurisdictionAddendum}}</textarea>
              </div>
              <div class="form-row">
                <label>Jurisdiction</label>
                <select id="cp-jurisdiction">
                  <option value="">-- No jurisdiction --</option>
                  <option value="US-VA">Virginia (US-VA)</option>
                  <option value="US-CA">California (US-CA)</option>
                  <option value="US-TX">Texas (US-TX)</option>
                  <option value="US-NY">New York (US-NY)</option>
                </select>
              </div>
              <div class="form-row">
                <label>Event Date</label>
                <input type="date" id="cp-eventDate">
                <p class="hint">Used for age validation (trainer/coach must be 18+ at event date)</p>
              </div>
            </div>

            <div>
              <div class="form-row">
                <label>Merge Variables (JSON)</label>
                <textarea id="cp-mergeVariables" style="min-height: 80px;">{
  "organizationName": "Sports Academy",
  "eventName": "Summer Training Camp"
}</textarea>
              </div>
              <div class="form-row">
                <label>External Reference</label>
                <input type="text" id="cp-externalRef" placeholder="your-system-id">
              </div>
              <div class="form-row">
                <label>Verification Method (optional)</label>
                <select id="cp-verificationMethod">
                  <option value="">Auto-detect from contact info</option>
                  <option value="email">Email only</option>
                  <option value="sms">SMS only</option>
                  <option value="both">Both required</option>
                </select>
                <p class="hint">Leave as auto-detect - uses email if provided, SMS if phone provided, both if both provided.</p>
              </div>
              <div class="form-row">
                <label>Callback URL</label>
                <input type="url" id="cp-callbackUrl" placeholder="https://your-server.com/webhook">
              </div>
            </div>
          </div>

          <div class="form-row" style="margin-top: 15px;">
            <label>Signers (JSON Array) *</label>
            <textarea id="cp-signers" style="min-height: 200px;">[
  {
    "role": "participant",
    "name": "John Athlete",
    "email": "john@example.com",
    "dateOfBirth": "2010-05-15",
    "isMinor": true,
    "isPackageAdmin": true
  },
  {
    "role": "guardian",
    "name": "Jane Parent",
    "email": "jane@example.com",
    "phone": "+15551234567",
    "dateOfBirth": "1985-03-20"
  },
  {
    "role": "coach",
    "name": "Mike Coach",
    "phone": "+15559876543",
    "dateOfBirth": "1990-01-10"
  }
]</textarea>
            <p class="hint">Roles: participant, guardian, trainer, coach, witness. Set <code>isPackageAdmin: true</code> on one signer to designate them as the decision maker who can replace signers. If not specified, the first signer becomes admin.</p>
          </div>

          <button class="btn-send" id="btn-createPackage">Create Package</button>
          <div id="response-createPackage" class="response-area" style="display:none;"></div>
        </div>

        <!-- Get Package -->
        <div class="endpoint-card">
          <h3><span class="method get">GET</span> Get Package Status</h3>
          <div class="endpoint-path">/api/packages/:id</div>

          <div class="form-row">
            <label>Package ID or Code *</label>
            <input type="text" id="gp-id" placeholder="Enter package ID or code">
            <button class="btn-quick use-saved" data-target="gp-id" data-field="packageId" style="margin-top:5px;">Use Saved</button>
          </div>

          <button class="btn-send" id="btn-getPackage">Get Package</button>
          <div id="response-getPackage" class="response-area" style="display:none;"></div>
        </div>

        <!-- List Packages -->
        <div class="endpoint-card">
          <h3><span class="method get">GET</span> List Packages</h3>
          <div class="endpoint-path">/api/packages</div>

          <div class="form-row">
            <label>Status Filter</label>
            <select id="lp-status">
              <option value="">All</option>
              <option value="pending">Pending</option>
              <option value="partial">Partial</option>
              <option value="complete">Complete</option>
              <option value="expired">Expired</option>
              <option value="cancelled">Cancelled</option>
            </select>
          </div>
          <div class="form-row">
            <label>External Reference</label>
            <input type="text" id="lp-externalRef" placeholder="Filter by external ref">
          </div>
          <div class="form-row">
            <label>Limit</label>
            <input type="number" id="lp-limit" value="10">
          </div>

          <button class="btn-send" id="btn-listPackages">List Packages</button>
          <div id="response-listPackages" class="response-area" style="display:none;"></div>
        </div>

        <!-- Jurisdictions -->
        <div class="endpoint-card">
          <h3><span class="method get">GET</span> List Jurisdictions</h3>
          <div class="endpoint-path">/api/jurisdictions</div>
          <p class="hint">View available jurisdiction addendums</p>

          <button class="btn-send" id="btn-listJurisdictions">List Jurisdictions</button>
          <div id="response-listJurisdictions" class="response-area" style="display:none;"></div>
        </div>

        <!-- Role Requirements -->
        <div class="endpoint-card">
          <h3><span class="method get">GET</span> Role Age Requirements</h3>
          <div class="endpoint-path">/api/roles/requirements</div>
          <p class="hint">View minimum age requirements for each role</p>

          <button class="btn-send" id="btn-roleRequirements">Get Requirements</button>
          <div id="response-roleRequirements" class="response-area" style="display:none;"></div>
        </div>

        <!-- Replace Signer -->
        <div class="endpoint-card" style="grid-column: span 2;">
          <h3><span class="method put">PUT</span> Replace Signer</h3>
          <div class="endpoint-path">/api/packages/:id/roles/:roleId</div>
          <p class="hint">Replace a signer who hasn't signed yet. Use this when someone refuses to sign and needs to be replaced.</p>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div>
              <div class="form-row">
                <label>Package ID or Code *</label>
                <input type="text" id="rs-packageId" placeholder="Enter package ID or code">
                <button class="btn-quick use-saved" data-target="rs-packageId" data-field="packageId" style="margin-top:5px;">Use Saved</button>
              </div>
              <div class="form-row">
                <label>Role ID *</label>
                <input type="text" id="rs-roleId" placeholder="Get from package status response">
                <p class="hint">Use "Get Package Status" to find the role ID</p>
              </div>
            </div>
            <div>
              <div class="form-row">
                <label>New Signer Name *</label>
                <input type="text" id="rs-name" placeholder="Full name">
              </div>
              <div class="form-row">
                <label>New Signer Email</label>
                <input type="email" id="rs-email" placeholder="email@example.com">
              </div>
              <div class="form-row">
                <label>New Signer Phone</label>
                <input type="tel" id="rs-phone" placeholder="+15551234567">
              </div>
              <div class="form-row">
                <label>Verification Method (optional)</label>
                <select id="rs-verificationMethod">
                  <option value="">Auto-detect</option>
                  <option value="email">Email only</option>
                  <option value="sms">SMS only</option>
                  <option value="both">Both</option>
                </select>
                <p class="hint">Auto-detects based on provided contact info</p>
              </div>
            </div>
          </div>

          <button class="btn-send" id="btn-replaceSigner">Replace Signer</button>
          <div id="response-replaceSigner" class="response-area" style="display:none;"></div>
        </div>

      </div>
    </div>

    <!-- TEMPLATES PANEL -->
    <div id="panel-templates" class="panel">
      <div class="endpoint-grid">

        <!-- Create Template -->
        <div class="endpoint-card">
          <h3><span class="method post">POST</span> Create Template</h3>
          <div class="endpoint-path">/api/templates</div>

          <div class="form-row">
            <label>Template Code *</label>
            <input type="text" id="ct-templateCode" placeholder="e.g., LIABILITY_WAIVER_2024">
          </div>
          <div class="form-row">
            <label>Name *</label>
            <input type="text" id="ct-name" placeholder="e.g., Standard Liability Waiver">
          </div>
          <div class="form-row">
            <label>Description</label>
            <input type="text" id="ct-description" placeholder="Template description">
          </div>
          <div class="form-row">
            <label>HTML Content *</label>
            <textarea id="ct-htmlContent">&lt;h2&gt;Liability Waiver&lt;/h2&gt;&lt;p&gt;I, {{signerName}}, acknowledge and accept all risks.&lt;/p&gt;</textarea>
          </div>
          <div class="form-row">
            <label>Jurisdiction</label>
            <input type="text" id="ct-jurisdiction" placeholder="e.g., US-VA">
          </div>

          <button class="btn-send" id="btn-createTemplate">Create Template</button>
          <div id="response-createTemplate" class="response-area" style="display:none;"></div>
        </div>

        <!-- List Templates -->
        <div class="endpoint-card">
          <h3><span class="method get">GET</span> List Templates</h3>
          <div class="endpoint-path">/api/templates</div>

          <div class="form-row">
            <label>Jurisdiction Filter</label>
            <input type="text" id="lt-jurisdiction" placeholder="Optional filter">
          </div>

          <button class="btn-send" id="btn-listTemplates">List Templates</button>
          <div id="response-listTemplates" class="response-area" style="display:none;"></div>
        </div>

        <!-- Get Template -->
        <div class="endpoint-card">
          <h3><span class="method get">GET</span> Get Template</h3>
          <div class="endpoint-path">/api/templates/:templateCode</div>

          <div class="form-row">
            <label>Template Code *</label>
            <input type="text" id="gt-templateCode" placeholder="Enter template code">
          </div>

          <button class="btn-send" id="btn-getTemplate">Get Template</button>
          <div id="response-getTemplate" class="response-area" style="display:none;"></div>
        </div>

        <!-- Update Template -->
        <div class="endpoint-card">
          <h3><span class="method put">PUT</span> Update Template</h3>
          <div class="endpoint-path">/api/templates/:templateCode</div>

          <div class="form-row">
            <label>Template Code *</label>
            <input type="text" id="ut-templateCode" placeholder="Enter template code">
          </div>
          <div class="form-row">
            <label>Name</label>
            <input type="text" id="ut-name" placeholder="New name">
          </div>
          <div class="form-row">
            <label>HTML Content</label>
            <textarea id="ut-htmlContent" placeholder="New HTML content"></textarea>
          </div>
          <div class="form-row">
            <label>Active</label>
            <select id="ut-isActive">
              <option value="">No change</option>
              <option value="true">Active</option>
              <option value="false">Inactive</option>
            </select>
          </div>

          <button class="btn-send" id="btn-updateTemplate">Update Template</button>
          <div id="response-updateTemplate" class="response-area" style="display:none;"></div>
        </div>

        <!-- Delete Template -->
        <div class="endpoint-card">
          <h3><span class="method delete">DELETE</span> Delete Template</h3>
          <div class="endpoint-path">/api/templates/:templateCode</div>

          <div class="form-row">
            <label>Template Code *</label>
            <input type="text" id="dt-templateCode" placeholder="Enter template code">
          </div>

          <button class="btn-send" id="btn-deleteTemplate">Delete Template</button>
          <div id="response-deleteTemplate" class="response-area" style="display:none;"></div>
        </div>

      </div>
    </div>

    <!-- SIGNING FLOW PANEL -->
    <div id="panel-signing" class="panel">
      <div class="endpoint-grid">

        <!-- Get Signing Page Data -->
        <div class="endpoint-card">
          <h3><span class="method get">GET</span> Get Signing Page Data</h3>
          <div class="endpoint-path">/sign/:token/data</div>
          <p class="hint">No API key required - public endpoint</p>

          <div class="form-row">
            <label>Token *</label>
            <input type="text" id="spd-token" placeholder="Enter signing token">
            <button class="btn-quick use-saved" data-target="spd-token" data-field="token" style="margin-top:5px;">Use Saved</button>
          </div>

          <button class="btn-send" id="btn-getSigningData">Get Data</button>
          <div id="response-getSigningData" class="response-area" style="display:none;"></div>
        </div>

        <!-- Send Verification Code -->
        <div class="endpoint-card">
          <h3><span class="method post">POST</span> Send Verification Code</h3>
          <div class="endpoint-path">/sign/:token/verify</div>
          <p class="hint">Sends email or SMS with verification code</p>

          <div class="form-row">
            <label>Token *</label>
            <input type="text" id="sv-token" placeholder="Enter signing token">
            <button class="btn-quick use-saved" data-target="sv-token" data-field="token" style="margin-top:5px;">Use Saved</button>
          </div>
          <div class="form-row">
            <label>Method *</label>
            <select id="sv-method">
              <option value="email">Email</option>
              <option value="sms">SMS</option>
            </select>
          </div>

          <button class="btn-send" id="btn-sendVerification">Send Code</button>
          <div id="response-sendVerification" class="response-area" style="display:none;"></div>
        </div>

        <!-- Confirm Verification Code -->
        <div class="endpoint-card">
          <h3><span class="method post">POST</span> Confirm Verification Code</h3>
          <div class="endpoint-path">/sign/:token/confirm</div>

          <div class="form-row">
            <label>Token *</label>
            <input type="text" id="cv-token" placeholder="Enter signing token">
            <button class="btn-quick use-saved" data-target="cv-token" data-field="token" style="margin-top:5px;">Use Saved</button>
          </div>
          <div class="form-row">
            <label>Verification Code *</label>
            <input type="text" id="cv-code" placeholder="6-digit code" maxlength="6">
          </div>

          <button class="btn-send" id="btn-confirmVerification">Confirm Code</button>
          <div id="response-confirmVerification" class="response-area" style="display:none;"></div>
        </div>

        <!-- Submit Signature -->
        <div class="endpoint-card">
          <h3><span class="method post">POST</span> Submit Signature</h3>
          <div class="endpoint-path">/sign/:token/submit</div>

          <div class="form-row">
            <label>Token *</label>
            <input type="text" id="ss-token" placeholder="Enter signing token">
            <button class="btn-quick use-saved" data-target="ss-token" data-field="token" style="margin-top:5px;">Use Saved</button>
          </div>
          <div class="form-row">
            <label>Signature Type *</label>
            <select id="ss-signatureType">
              <option value="typed">Typed</option>
              <option value="drawn">Drawn</option>
            </select>
          </div>
          <div class="form-row">
            <label>Typed Name (for typed signature)</label>
            <input type="text" id="ss-typedName" placeholder="Full name as signature">
          </div>
          <div class="form-row">
            <label>Consent Text</label>
            <input type="text" id="ss-consentText" value="I agree to sign this document electronically">
          </div>

          <button class="btn-send" id="btn-submitSignature">Submit Signature</button>
          <div id="response-submitSignature" class="response-area" style="display:none;"></div>
        </div>

        <!-- Open Signing Page -->
        <div class="endpoint-card">
          <h3><span class="method get">GET</span> Open Signing Page</h3>
          <div class="endpoint-path">/sign/:token</div>
          <p class="hint">Opens the actual signing page in a new tab</p>

          <div class="form-row">
            <label>Token *</label>
            <input type="text" id="op-token" placeholder="Enter signing token">
            <button class="btn-quick use-saved" data-target="op-token" data-field="token" style="margin-top:5px;">Use Saved</button>
          </div>

          <button class="btn-send" id="btn-openSigningPage">Open Signing Page</button>
        </div>

      </div>
    </div>

    <!-- FULL TEST PANEL -->
    <div id="panel-fulltest" class="panel">
      <div class="endpoint-card" style="max-width: 600px;">
        <h3>Complete End-to-End Test</h3>
        <p>Run a full test of the signature flow: Create request, send verification, confirm code, and submit signature.</p>

        <div class="form-row">
          <label>Your Email (will receive verification code)</label>
          <input type="email" id="ft-email" placeholder="your-real-email@example.com">
        </div>
        <div class="form-row">
          <label>Your Phone (optional, E.164 format)</label>
          <input type="tel" id="ft-phone" placeholder="+15551234567">
        </div>
        <div class="form-row">
          <label>Your Name</label>
          <input type="text" id="ft-name" value="Test Signer">
        </div>
        <div class="form-row">
          <label>Verification Method</label>
          <select id="ft-method">
            <option value="email">Email</option>
            <option value="sms">SMS</option>
          </select>
        </div>

        <button class="btn-send" id="ft-btn">Start Full Test</button>

        <div id="ft-log" class="response-area" style="display:none;">
          <div class="response-header">
            <span>Test Progress</span>
          </div>
          <div class="response-body" id="ft-log-body"></div>
        </div>

        <div id="ft-verify" style="display:none; margin-top: 15px;">
          <div class="form-row">
            <label>Enter the verification code you received:</label>
            <input type="text" id="ft-code" placeholder="6-digit code" maxlength="6">
          </div>
          <button class="btn-send" id="ft-continue-btn">Continue Test</button>
        </div>
      </div>
    </div>

  </div>

  <script src="/js/test-console.js"></script>
</body>
</html>
